> WITH  MaxSchedule AS (     SELECT          IZBRNM, IZDLP, IZDLR, MAX(IZDTES) AS Max_IZDTES     FROM kfilpmo.izpf     GROUP BY IZBRNM, IZDLP, IZDLR ), FirstRepayData AS (     SELECT          IZBRNM, IZDLP, IZDLR, IZNDT AS FirstRepayDate, IZNPY AS RepayPeriod, IZCRAN,         ROW_NUMBER() OVER (PARTITION BY IZBRNM, IZDLP, IZDLR ORDER BY IZNDT ASC) AS rn     FROM kfilpmo.izpf  )  SELECT DISTINCT      (a.IZBRNM||a.IZDLP||a.IZDLR) AS UniqueID,      a.IZDTES AS LastSchDate,     a.IZCRA  AS InstallmentSize,     f.FirstRepayDate,     f.RepayPeriod,     f.IZCRAN  AS FirstRepayAmount FROM kfilpmo.izpf a INNER JOIN MaxSchedule m      ON a.IZBRNM = m.IZBRNM      AND a.IZDLP = m.IZDLP      AND a.IZDLR = m.IZDLR      AND a.IZDTES = m.Max_IZDTES INNER JOIN FirstRepayData f     ON a.IZBRNM = f.IZBRNM      AND a.IZDLP = f.IZDLP      AND a.IZDLR = f.IZDLR     AND f.rn = 1 INNER JOIN kfilpmo.OSPF o      ON a.IZBRNM = o.OSBRNM      AND a.IZDLP = o.OSDLP      AND a.IZDLR = o.OSDLR WHERE o.OSAPP = 'RL'    AND o.OSARC = ''

Statement ran successfully   (1421 ms)

> WITH  NearestSchedule AS (     SELECT          iz.IZBRNM, iz.IZDLP, iz.IZDLR, iz.IZDTES, iz.IZCRA,         ROW_NUMBER() OVER (             PARTITION BY iz.IZBRNM, iz.IZDLP, iz.IZDLR             ORDER BY ABS(DAYS(iz.IZDTES) - DAYS(t4.T4PDAT))         ) AS rn_nearest     FROM kfilpmo.izpf iz     LEFT JOIN kfilpmo.T4PF t4 ON 1=1 ), FirstRepayData AS (     SELECT          IZBRNM, IZDLP, IZDLR, IZNDT AS FirstRepayDate, IZNPY AS RepayPeriod, IZCRAN,         ROW_NUMBER() OVER (PARTITION BY IZBRNM, IZDLP, IZDLR ORDER BY IZNDT ASC) AS rn     FROM kfilpmo.izpf )  SELECT DISTINCT      (a.IZBRNM || a.IZDLP || a.IZDLR) AS UniqueID,     a.IZDTES AS NearestSchDate,     a.IZCRA AS InstallmentSize,     f.FirstRepayDate,     f.RepayPeriod,     f.IZCRAN AS FirstRepayAmount,     t4.T4PDAT AS ReferenceDate FROM NearestSchedule a INNER JOIN FirstRepayData f     ON a.IZBRNM = f.IZBRNM      AND a.IZDLP = f.IZDLP      AND a.IZDLR = f.IZDLR      AND f.rn = 1 INNER JOIN kfilpmo.OSPF o      ON a.IZBRNM = o.OSBRNM      AND a.IZDLP = o.OSDLP      AND a.IZDLR = o.OSDLR LEFT JOIN kfilpmo.T4PF t4 ON 1=1 WHERE a.rn_nearest = 1   AND o.OSAPP = 'RL'    AND o.OSARC = ''

SQL State: 42815
Vendor Code: -171
Message: [SQL0171] Argument 1 of function DAYS not valid. Cause . . . . . :   The data type, length, or value of argument 1 of function DAYS specified is not valid. Recovery  . . . :   Refer to the DB2 for IBM i SQL Reference topic collection in the Database category in the IBM i Information Center for more information on scalar functions. Correct the arguments specified for the function. Try the request again.

Processing ended because the highlighted statement did not complete successfully
